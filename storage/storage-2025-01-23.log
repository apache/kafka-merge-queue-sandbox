2025-01-23 13:13:48,189 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-alterlogdirtest1126439335127856305/kafka-tiered-storage]
2025-01-23 13:13:48,243 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:13:48,259 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:55229, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=vTlLb_iUTCKhLPtPA7Raew, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-14421960663846399375}
2025-01-23 13:13:48,444 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:55229}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:55229, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:55229, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:13:48,449 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:13:48,613 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:48,633 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:13:48,643 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:49,073 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:49,099 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:13:49,104 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:49,117 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-alterlogdirtest1126439335127856305] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:13:49,129 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Created local tiered storage manager [1]:[kafka-tiered-storage]
2025-01-23 13:13:49,134 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:55332, broker.id=1, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=vTlLb_iUTCKhLPtPA7Raew, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8741606631007080546}
2025-01-23 13:13:49,134 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_1', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:55332}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:55332, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_1_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:55332, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_1_producer}}
2025-01-23 13:13:49,137 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:13:49,236 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:49,338 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: GgSNYaK8RpO_pk7uDvo_vA, numPartitions: 5, replicationFactor: 2, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:13:49,410 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata exists. TopicId: GgSNYaK8RpO_pk7uDvo_vA, numPartitions: 5, 
2025-01-23 13:13:49,415 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:13:49,427 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:13:49,421 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:13:49,437 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:13:49,415 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:13:49,421 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:13:50,075 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:50,091 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:50,098 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:50,102 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:13:50,104 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:50,177 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and follower partitions []
2025-01-23 13:13:50,193 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:50,212 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:13:50,213 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:50,229 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:50,241 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:50,249 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:50,250 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:50,256 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and follower partitions []
2025-01-23 13:13:50,286 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:50,253 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 150 ms
2025-01-23 13:13:50,338 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 114 ms
2025-01-23 13:13:50,287 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:50,432 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and follower partitions []
2025-01-23 13:13:50,435 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:50,497 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:50,503 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:50,817 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Found the logStartOffset: 0 for partition: rCnEjGdjRviDDp-vb_z5PQ:topicB-0 after becoming leader
2025-01-23 13:13:50,826 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: rCnEjGdjRviDDp-vb_z5PQ:topicB-0 after becoming leader
2025-01-23 13:13:50,831 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:13:50,907 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 0
2025-01-23 13:13:50,915 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-alterlogdirtest1126439335127856305/kafka-tiered-storage/topicB-0-rCnEjGdjRviDDp-vb_z5PQ
2025-01-23 13:13:50,930 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for rCnEjGdjRviDDp-vb_z5PQ:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8741606631007080546/topicB-0/00000000000000000000.log
2025-01-23 13:13:51,039 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 1
2025-01-23 13:13:51,090 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0, id=ollDIlqkQgOsM5zpLDKrgg}
2025-01-23 13:13:51,092 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:13:51,121 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 2
2025-01-23 13:13:51,126 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for rCnEjGdjRviDDp-vb_z5PQ:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8741606631007080546/topicB-0/00000000000000000001.log
2025-01-23 13:13:51,159 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 3
2025-01-23 13:13:51,174 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0, id=cltWTLofRI28enu7mi3Xfw}
2025-01-23 13:13:53,701 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and follower partitions []
2025-01-23 13:13:53,706 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:53,786 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:53,789 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:53,846 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:53,850 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:53,846 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and follower partitions []
2025-01-23 13:13:53,850 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:53,890 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:53,890 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:53,905 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:53,914 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:53,918 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:53,922 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:53,927 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and follower partitions []
2025-01-23 13:13:53,932 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:53,935 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:53,936 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:53,940 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:53,945 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:53,945 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:53,945 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Found the logStartOffset: 0 for partition: rCnEjGdjRviDDp-vb_z5PQ:topicB-0 after becoming leader
2025-01-23 13:13:53,945 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: rCnEjGdjRviDDp-vb_z5PQ:topicB-0 after becoming leader
2025-01-23 13:13:54,447 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:13:54,478 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 4
2025-01-23 13:13:54,483 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for rCnEjGdjRviDDp-vb_z5PQ:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-14421960663846399375/topicB-0/00000000000000000002.log
2025-01-23 13:13:54,577 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 5
2025-01-23 13:13:54,578 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=rCnEjGdjRviDDp-vb_z5PQ:topicB-0, id=iBcE5q4QTOK6q1SYiMnXjQ}
2025-01-23 13:13:57,001 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: rCnEjGdjRviDDp-vb_z5PQ:topicB-0
2025-01-23 13:13:57,002 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: rCnEjGdjRviDDp-vb_z5PQ:topicB-0
2025-01-23 13:13:57,005 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:57,005 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower RLM task for partition: rCnEjGdjRviDDp-vb_z5PQ:topicB-0
2025-01-23 13:13:57,007 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:57,007 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:57,007 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:57,008 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [rCnEjGdjRviDDp-vb_z5PQ:topicB-0]
2025-01-23 13:13:57,008 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and removed: []
2025-01-23 13:13:57,008 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] and getting scheduled
2025-01-23 13:13:57,008 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[rCnEjGdjRviDDp-vb_z5PQ:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:57,435 [scala-execution-context-global-280] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:13:57,435 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:13:57,447 [scala-execution-context-global-280] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:13:57,447 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:13:57,461 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:13:57,472 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:13:57,476 [scala-execution-context-global-280] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:13:57,476 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:13:57,480 [scala-execution-context-global-280] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:13:57,484 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:13:57,490 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:13:57,490 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:13:57,493 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:13:57,497 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:13:57,506 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:13:57,511 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:13:57,511 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:13:57,525 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:13:57,528 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:13:57,535 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:13:57,544 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:13:57,545 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:13:57,554 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:13:57,562 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:13:57,578 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:13:57,590 [scala-execution-context-global-280] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:13:58,749 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-alterlogdirtest1157763339641754724/kafka-tiered-storage]
2025-01-23 13:13:58,755 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:13:58,759 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:56017, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=rmmIOpcRSgWnkxL8kiAPrw, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-5424771080823247150}
2025-01-23 13:13:58,763 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:56017}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:56017, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:56017, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:13:58,765 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:13:58,876 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:58,881 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:13:58,881 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:58,953 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-alterlogdirtest1157763339641754724] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:13:58,962 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Created local tiered storage manager [1]:[kafka-tiered-storage]
2025-01-23 13:13:58,978 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:56040, broker.id=1, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=rmmIOpcRSgWnkxL8kiAPrw, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-9303368471573575882}
2025-01-23 13:13:58,982 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_1', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:56040}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:56040, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_1_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:56040, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_1_producer}}
2025-01-23 13:13:58,993 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:13:59,035 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:59,100 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: bV2FKimxQHaVytR98DqXqQ, numPartitions: 5, replicationFactor: 2, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:13:59,106 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:59,188 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:59,198 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic [__remote_log_metadata] already exists
2025-01-23 13:13:59,202 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:59,416 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:13:59,416 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:13:59,417 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:13:59,519 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:13:59,521 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:13:59,520 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:13:59,863 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:13:59,866 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:13:59,866 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0] and follower partitions []
2025-01-23 13:13:59,875 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:13:59,875 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:13:59,884 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:13:59,904 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:59,908 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:13:59,908 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:13:59,926 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:59,932 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:13:59,936 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:00,008 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 103 ms
2025-01-23 13:14:00,037 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 104 ms
2025-01-23 13:14:00,067 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0] and follower partitions []
2025-01-23 13:14:00,067 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:00,070 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:00,071 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:00,438 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Found the logStartOffset: 0 for partition: 71ffUUFgQO6MqMu3A4l92w:topicB-0 after becoming leader
2025-01-23 13:14:00,447 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: 71ffUUFgQO6MqMu3A4l92w:topicB-0 after becoming leader
2025-01-23 13:14:00,456 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:00,565 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 0
2025-01-23 13:14:00,575 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-alterlogdirtest1157763339641754724/kafka-tiered-storage/topicB-0-71ffUUFgQO6MqMu3A4l92w
2025-01-23 13:14:00,619 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for 71ffUUFgQO6MqMu3A4l92w:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-9303368471573575882/topicB-0/00000000000000000000.log
2025-01-23 13:14:00,699 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 1
2025-01-23 13:14:00,708 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=71ffUUFgQO6MqMu3A4l92w:topicB-0, id=ENuArr19TAunuADsrc7wtA}
2025-01-23 13:14:00,714 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:14:00,734 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 2
2025-01-23 13:14:00,742 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for 71ffUUFgQO6MqMu3A4l92w:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-9303368471573575882/topicB-0/00000000000000000001.log
2025-01-23 13:14:00,789 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 3
2025-01-23 13:14:00,792 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=71ffUUFgQO6MqMu3A4l92w:topicB-0, id=H5Lme3l5RXyUWWfnvZ4bIA}
2025-01-23 13:14:03,426 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0] and follower partitions []
2025-01-23 13:14:03,428 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:03,511 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:03,516 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:03,517 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0] and follower partitions []
2025-01-23 13:14:03,520 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:03,521 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:03,524 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:03,567 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:03,570 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:03,574 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:03,582 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:03,592 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:14:03,605 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:03,628 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0] and follower partitions []
2025-01-23 13:14:03,636 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:03,642 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:03,654 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:14:03,663 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:03,666 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:14:03,685 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:03,667 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Found the logStartOffset: 0 for partition: 71ffUUFgQO6MqMu3A4l92w:topicB-0 after becoming leader
2025-01-23 13:14:03,701 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: 71ffUUFgQO6MqMu3A4l92w:topicB-0 after becoming leader
2025-01-23 13:14:04,212 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:04,231 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 4
2025-01-23 13:14:04,235 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for 71ffUUFgQO6MqMu3A4l92w:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-5424771080823247150/topicB-0/00000000000000000002.log
2025-01-23 13:14:04,295 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 5
2025-01-23 13:14:04,299 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=71ffUUFgQO6MqMu3A4l92w:topicB-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=71ffUUFgQO6MqMu3A4l92w:topicB-0, id=igjOH_sdSfSwgebOQlsQ2A}
2025-01-23 13:14:06,540 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: 71ffUUFgQO6MqMu3A4l92w:topicB-0
2025-01-23 13:14:06,540 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower RLM task for partition: 71ffUUFgQO6MqMu3A4l92w:topicB-0
2025-01-23 13:14:06,544 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: 71ffUUFgQO6MqMu3A4l92w:topicB-0
2025-01-23 13:14:06,545 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:06,547 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:06,548 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [71ffUUFgQO6MqMu3A4l92w:topicB-0]
2025-01-23 13:14:06,551 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:14:06,551 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [71ffUUFgQO6MqMu3A4l92w:topicB-0] and removed: []
2025-01-23 13:14:06,551 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:06,551 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] and getting scheduled
2025-01-23 13:14:06,551 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[71ffUUFgQO6MqMu3A4l92w:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:06,902 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:06,907 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:06,910 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:06,911 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:06,912 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:06,917 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:06,917 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:06,918 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:06,921 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:06,921 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:06,921 [scala-execution-context-global-279] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:06,921 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:06,922 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:06,922 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:06,922 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:06,922 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:06,922 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:06,922 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:06,922 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:06,922 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:06,922 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:06,922 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:06,922 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:06,922 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:06,922 [scala-execution-context-global-279] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:06,922 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:07,356 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest16913193667452482619/kafka-tiered-storage]
2025-01-23 13:14:07,357 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:14:07,358 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=1, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:56681, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=PRS7bAaeRlaSJkmNKLZLpA, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2185041684407078001}
2025-01-23 13:14:07,363 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=1, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:56681}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:56681, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:56681, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:14:07,372 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:07,479 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:07,510 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: FtofScRqSW2iXNbc6v_gNg, numPartitions: 5, replicationFactor: 1, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:14:07,518 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:07,518 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:07,521 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:07,733 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and follower partitions []
2025-01-23 13:14:07,733 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and removed: []
2025-01-23 13:14:07,734 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and getting scheduled
2025-01-23 13:14:07,734 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:07,734 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:07,735 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and getting scheduled
2025-01-23 13:14:07,735 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:07,845 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 110 ms
2025-01-23 13:14:07,893 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and follower partitions []
2025-01-23 13:14:07,897 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and removed: []
2025-01-23 13:14:08,237 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Found the logStartOffset: 0 for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0 after becoming leader
2025-01-23 13:14:08,239 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0 after becoming leader
2025-01-23 13:14:08,251 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:08,275 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 0
2025-01-23 13:14:08,280 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest16913193667452482619/kafka-tiered-storage/topicA-0-G6mYnhHjTtqW-3_aWHrrsw
2025-01-23 13:14:08,298 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for G6mYnhHjTtqW-3_aWHrrsw:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2185041684407078001/topicA-0/00000000000000000000.log
2025-01-23 13:14:08,455 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 1
2025-01-23 13:14:08,461 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0, id=JMFAheHRS3K3Rci1WTQVbw}
2025-01-23 13:14:08,465 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:14:08,479 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 2
2025-01-23 13:14:08,485 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for G6mYnhHjTtqW-3_aWHrrsw:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2185041684407078001/topicA-0/00000000000000000001.log
2025-01-23 13:14:08,619 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 4 up-to offset 3
2025-01-23 13:14:08,623 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0, id=_F6vB-kkRTW4FWMlD4I4aA}
2025-01-23 13:14:09,737 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [IxqySwGoTNWMSfNH7oNV3g:topicB-0] and follower partitions []
2025-01-23 13:14:09,741 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [IxqySwGoTNWMSfNH7oNV3g:topicB-0] and removed: []
2025-01-23 13:14:09,742 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] and getting scheduled
2025-01-23 13:14:09,746 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:09,747 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] and getting scheduled
2025-01-23 13:14:09,752 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:09,831 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:09,899 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [IxqySwGoTNWMSfNH7oNV3g:topicB-0] and follower partitions []
2025-01-23 13:14:09,903 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [IxqySwGoTNWMSfNH7oNV3g:topicB-0] and removed: []
2025-01-23 13:14:10,125 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 2 meta-partitions in 288 ms
2025-01-23 13:14:10,276 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Found the logStartOffset: 0 for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0 after becoming leader
2025-01-23 13:14:10,282 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0 after becoming leader
2025-01-23 13:14:10,396 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:10,411 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 0
2025-01-23 13:14:10,415 [kafka-rlm-copy-thread-pool-3] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest16913193667452482619/kafka-tiered-storage/topicB-0-IxqySwGoTNWMSfNH7oNV3g
2025-01-23 13:14:10,419 [kafka-rlm-copy-thread-pool-3] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for IxqySwGoTNWMSfNH7oNV3g:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-17109655198420850299/topicB-0/00000000000000000000.log
2025-01-23 13:14:10,438 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 1
2025-01-23 13:14:10,443 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=IxqySwGoTNWMSfNH7oNV3g:topicB-0, id=5dImlnhJQe6Av7fPwZFztQ}
2025-01-23 13:14:10,449 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:10,470 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 2
2025-01-23 13:14:10,474 [kafka-rlm-copy-thread-pool-3] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for IxqySwGoTNWMSfNH7oNV3g:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-17109655198420850299/topicB-0/00000000000000000002.log
2025-01-23 13:14:10,580 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 3
2025-01-23 13:14:10,585 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=IxqySwGoTNWMSfNH7oNV3g:topicB-0, id=rIHpEUjRRnCpvQ-NjSbCyw}
2025-01-23 13:14:11,682 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0
2025-01-23 13:14:11,687 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0
2025-01-23 13:14:11,687 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0
2025-01-23 13:14:11,687 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0
2025-01-23 13:14:11,688 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0]
2025-01-23 13:14:11,688 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0] and removed: []
2025-01-23 13:14:11,688 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and getting scheduled
2025-01-23 13:14:11,694 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:11,698 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] and getting scheduled
2025-01-23 13:14:11,702 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:11,991 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:11,993 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:11,996 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:12,000 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:12,000 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:12,004 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:12,008 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:12,008 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:12,009 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:12,013 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:12,017 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:12,017 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:12,018 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:12,459 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest16913193667452482619] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:14:12,461 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:14:12,461 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=1, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:57035, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=PRS7bAaeRlaSJkmNKLZLpA, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2185041684407078001}
2025-01-23 13:14:12,465 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=1, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:57035}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:57035, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:57035, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:14:12,465 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:12,501 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0]
2025-01-23 13:14:12,503 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and getting scheduled
2025-01-23 13:14:12,503 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:12,504 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] and getting scheduled
2025-01-23 13:14:12,508 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:25,241 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata exists. TopicId: FtofScRqSW2iXNbc6v_gNg, numPartitions: 5, 
2025-01-23 13:14:25,248 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:25,249 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0] and removed: []
2025-01-23 13:14:25,249 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:25,248 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:25,249 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:25,298 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0] and follower partitions []
2025-01-23 13:14:25,298 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0] and removed: []
2025-01-23 13:14:25,298 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0]
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and getting scheduled
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and getting scheduled
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0]
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] and getting scheduled
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] and getting scheduled
2025-01-23 13:14:25,299 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:25,374 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 2 meta-partitions in 121 ms
2025-01-23 13:14:25,804 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Found the logStartOffset: 0 for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0 after becoming leader
2025-01-23 13:14:25,804 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Found the logStartOffset: 0 for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0 after becoming leader
2025-01-23 13:14:25,806 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=IxqySwGoTNWMSfNH7oNV3g:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=3, leaderEpoch=0)] for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0 after becoming leader
2025-01-23 13:14:25,806 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=G6mYnhHjTtqW-3_aWHrrsw:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0 after becoming leader
2025-01-23 13:14:55,811 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: G6mYnhHjTtqW-3_aWHrrsw:topicA-0
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: IxqySwGoTNWMSfNH7oNV3g:topicB-0
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0]
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [G6mYnhHjTtqW-3_aWHrrsw:topicA-0, IxqySwGoTNWMSfNH7oNV3g:topicB-0] and removed: []
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] and getting scheduled
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[G6mYnhHjTtqW-3_aWHrrsw:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] and getting scheduled
2025-01-23 13:14:55,814 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[IxqySwGoTNWMSfNH7oNV3g:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:55,936 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:55,936 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:55,937 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:55,937 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:56,106 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest9435268488750111354/kafka-tiered-storage]
2025-01-23 13:14:56,107 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:14:56,107 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=1, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:58292, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=Z5Q5Cn3vTkCv_iuwGOYHCA, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-1985935631886051635}
2025-01-23 13:14:56,107 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=1, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:58292}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:58292, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:58292, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:14:56,107 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:56,211 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:56,241 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: XYy-fLsuTCuiANqfijMh3A, numPartitions: 5, replicationFactor: 1, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:14:56,248 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:56,248 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:56,250 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:56,441 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [vtPqY6gLTaipLgngUw-t8Q:topicA-0] and follower partitions []
2025-01-23 13:14:56,441 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [vtPqY6gLTaipLgngUw-t8Q:topicA-0] and removed: []
2025-01-23 13:14:56,441 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] and getting scheduled
2025-01-23 13:14:56,441 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:56,441 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:56,442 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] and getting scheduled
2025-01-23 13:14:56,442 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:56,544 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 102 ms
2025-01-23 13:14:56,573 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [vtPqY6gLTaipLgngUw-t8Q:topicA-0] and follower partitions []
2025-01-23 13:14:56,576 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [vtPqY6gLTaipLgngUw-t8Q:topicA-0] and removed: []
2025-01-23 13:14:56,943 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Found the logStartOffset: 0 for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0 after becoming leader
2025-01-23 13:14:56,943 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0 after becoming leader
2025-01-23 13:14:56,943 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:56,949 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 0
2025-01-23 13:14:57,001 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest9435268488750111354/kafka-tiered-storage/topicA-0-vtPqY6gLTaipLgngUw-t8Q
2025-01-23 13:14:57,002 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for vtPqY6gLTaipLgngUw-t8Q:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-1985935631886051635/topicA-0/00000000000000000000.log
2025-01-23 13:14:57,008 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 1
2025-01-23 13:14:57,060 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=vtPqY6gLTaipLgngUw-t8Q:topicA-0, id=yGLFAP9VQwGkS7W7MupS8w}
2025-01-23 13:14:57,060 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:14:57,066 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 2
2025-01-23 13:14:57,117 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for vtPqY6gLTaipLgngUw-t8Q:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-1985935631886051635/topicA-0/00000000000000000001.log
2025-01-23 13:14:57,123 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 3
2025-01-23 13:14:57,176 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=vtPqY6gLTaipLgngUw-t8Q:topicA-0, id=leqIKdNsQBO-KQUSqlZseQ}
2025-01-23 13:14:58,223 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [efsalfNCToO4qkos9JzZdg:topicB-0] and follower partitions []
2025-01-23 13:14:58,223 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [efsalfNCToO4qkos9JzZdg:topicB-0] and removed: []
2025-01-23 13:14:58,224 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[efsalfNCToO4qkos9JzZdg:topicB-0] and getting scheduled
2025-01-23 13:14:58,224 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[efsalfNCToO4qkos9JzZdg:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:58,224 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[efsalfNCToO4qkos9JzZdg:topicB-0] and getting scheduled
2025-01-23 13:14:58,224 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[efsalfNCToO4qkos9JzZdg:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:58,231 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:58,356 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [efsalfNCToO4qkos9JzZdg:topicB-0] and follower partitions []
2025-01-23 13:14:58,360 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [efsalfNCToO4qkos9JzZdg:topicB-0] and removed: []
2025-01-23 13:14:58,629 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 2 meta-partitions in 397 ms
2025-01-23 13:14:58,725 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Found the logStartOffset: 0 for partition: efsalfNCToO4qkos9JzZdg:topicB-0 after becoming leader
2025-01-23 13:14:58,725 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: efsalfNCToO4qkos9JzZdg:topicB-0 after becoming leader
2025-01-23 13:14:58,726 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:58,731 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 0
2025-01-23 13:14:58,783 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest9435268488750111354/kafka-tiered-storage/topicB-0-efsalfNCToO4qkos9JzZdg
2025-01-23 13:14:58,783 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for efsalfNCToO4qkos9JzZdg:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-12148050622028315417/topicB-0/00000000000000000000.log
2025-01-23 13:14:58,790 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 1
2025-01-23 13:14:58,840 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=efsalfNCToO4qkos9JzZdg:topicB-0, id=ywWaXfanS4SBEMmoHXFeCQ}
2025-01-23 13:14:58,840 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:58,847 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 2
2025-01-23 13:14:58,901 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for efsalfNCToO4qkos9JzZdg:topicB-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-12148050622028315417/topicB-0/00000000000000000002.log
2025-01-23 13:14:58,908 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 2 up-to offset 3
2025-01-23 13:14:58,959 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=efsalfNCToO4qkos9JzZdg:topicB-0, id=jX0M1UCSRcu5qKLCk3xuCA}
2025-01-23 13:15:00,029 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0
2025-01-23 13:15:00,032 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0
2025-01-23 13:15:00,036 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: efsalfNCToO4qkos9JzZdg:topicB-0
2025-01-23 13:15:00,040 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: efsalfNCToO4qkos9JzZdg:topicB-0
2025-01-23 13:15:00,044 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0]
2025-01-23 13:15:00,048 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0] and removed: []
2025-01-23 13:15:00,052 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] and getting scheduled
2025-01-23 13:15:00,056 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:00,060 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[efsalfNCToO4qkos9JzZdg:topicB-0] and getting scheduled
2025-01-23 13:15:00,060 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[efsalfNCToO4qkos9JzZdg:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:00,390 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:15:00,391 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:15:00,396 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:15:00,408 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:15:00,412 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:15:00,416 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:15:00,425 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:15:00,429 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:15:00,433 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:15:00,437 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:15:00,441 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:15:00,445 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:15:00,453 [Test worker] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:15:00,590 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-offloadandconsumefromleadertest9435268488750111354] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:15:00,594 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:15:00,594 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=1, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:58412, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=Z5Q5Cn3vTkCv_iuwGOYHCA, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-1985935631886051635}
2025-01-23 13:15:00,594 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=1, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:58412}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:58412, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:58412, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:15:00,595 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:15:00,655 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0]
2025-01-23 13:15:00,658 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] and getting scheduled
2025-01-23 13:15:00,661 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:00,661 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[efsalfNCToO4qkos9JzZdg:topicB-0] and getting scheduled
2025-01-23 13:15:00,661 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[efsalfNCToO4qkos9JzZdg:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:13,335 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata exists. TopicId: XYy-fLsuTCuiANqfijMh3A, numPartitions: 5, 
2025-01-23 13:15:13,338 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:15:13,340 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0] and removed: []
2025-01-23 13:15:13,338 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:15:13,340 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:15:13,340 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0] and follower partitions []
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0] and removed: []
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0]
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] and getting scheduled
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] and getting scheduled
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[efsalfNCToO4qkos9JzZdg:topicB-0]
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[efsalfNCToO4qkos9JzZdg:topicB-0] and getting scheduled
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[efsalfNCToO4qkos9JzZdg:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[efsalfNCToO4qkos9JzZdg:topicB-0] and getting scheduled
2025-01-23 13:15:13,389 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[efsalfNCToO4qkos9JzZdg:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:13,449 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 2 meta-partitions in 109 ms
2025-01-23 13:15:13,891 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Found the logStartOffset: 0 for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0 after becoming leader
2025-01-23 13:15:13,891 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Found the logStartOffset: 0 for partition: efsalfNCToO4qkos9JzZdg:topicB-0 after becoming leader
2025-01-23 13:15:13,896 [kafka-rlm-copy-thread-pool-3] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=efsalfNCToO4qkos9JzZdg:topicB-0] Found the highest copiedRemoteOffset: Optional[(offset=3, leaderEpoch=0)] for partition: efsalfNCToO4qkos9JzZdg:topicB-0 after becoming leader
2025-01-23 13:15:13,896 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=vtPqY6gLTaipLgngUw-t8Q:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0 after becoming leader
2025-01-23 13:15:43,883 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0
2025-01-23 13:15:43,885 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: vtPqY6gLTaipLgngUw-t8Q:topicA-0
2025-01-23 13:15:43,885 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: efsalfNCToO4qkos9JzZdg:topicB-0
2025-01-23 13:15:43,885 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: efsalfNCToO4qkos9JzZdg:topicB-0
2025-01-23 13:15:43,886 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0]
2025-01-23 13:15:43,886 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [vtPqY6gLTaipLgngUw-t8Q:topicA-0, efsalfNCToO4qkos9JzZdg:topicB-0] and removed: []
2025-01-23 13:15:43,886 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] and getting scheduled
2025-01-23 13:15:43,886 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[vtPqY6gLTaipLgngUw-t8Q:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:43,886 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[efsalfNCToO4qkos9JzZdg:topicB-0] and getting scheduled
2025-01-23 13:15:43,886 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[efsalfNCToO4qkos9JzZdg:topicB-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:15:44,026 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:15:44,027 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:15:44,028 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:15:44,029 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:15:44,030 [scala-execution-context-global-281] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
