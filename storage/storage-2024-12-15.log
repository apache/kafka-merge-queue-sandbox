2025-01-23 13:13:47,864 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-deletesegmentsduetologstartoffsetbreachtest4695901453380373089/kafka-tiered-storage]
2025-01-23 13:13:47,909 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:13:47,924 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:55180, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=6g0jPIhLQRyE2DkPk6iBZw, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8211840821323620363}
2025-01-23 13:13:47,930 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:55180}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:55180, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:55180, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:13:47,935 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:13:48,118 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:48,182 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:13:48,187 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:48,511 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:48,521 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:13:48,529 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:48,718 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-deletesegmentsduetologstartoffsetbreachtest4695901453380373089] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:13:48,762 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Created local tiered storage manager [1]:[kafka-tiered-storage]
2025-01-23 13:13:48,765 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:55296, broker.id=1, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=6g0jPIhLQRyE2DkPk6iBZw, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-655174550484439583}
2025-01-23 13:13:48,774 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_1', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:55296}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:55296, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_1_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:55296, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_1_producer}}
2025-01-23 13:13:48,785 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:13:48,855 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:13:48,901 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: Xvc7rIB0So61iAV3-M1SoQ, numPartitions: 5, replicationFactor: 2, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:13:48,920 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:13:49,087 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata exists. TopicId: Xvc7rIB0So61iAV3-M1SoQ, numPartitions: 5, 
2025-01-23 13:13:49,240 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:13:49,242 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:13:49,240 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:13:49,241 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:13:49,241 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:13:49,273 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:13:50,004 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:50,020 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:50,028 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:50,031 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:50,033 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:13:50,149 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and follower partitions []
2025-01-23 13:13:50,166 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:50,177 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:50,193 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:50,188 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:50,178 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:13:50,209 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:50,230 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:50,212 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:50,239 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and follower partitions []
2025-01-23 13:13:50,203 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 141 ms
2025-01-23 13:13:50,249 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:50,336 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 112 ms
2025-01-23 13:13:50,412 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:50,418 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and follower partitions []
2025-01-23 13:13:50,423 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:50,436 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:50,716 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Found the logStartOffset: 0 for partition: v_3Veo5vRom9QXayo7nXVQ:topicA-0 after becoming leader
2025-01-23 13:13:50,775 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: v_3Veo5vRom9QXayo7nXVQ:topicA-0 after becoming leader
2025-01-23 13:13:51,331 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:13:51,491 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 0
2025-01-23 13:13:51,528 [kafka-rlm-copy-thread-pool-2] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-deletesegmentsduetologstartoffsetbreachtest4695901453380373089/kafka-tiered-storage/topicA-0-v_3Veo5vRom9QXayo7nXVQ
2025-01-23 13:13:51,559 [kafka-rlm-copy-thread-pool-2] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for v_3Veo5vRom9QXayo7nXVQ:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8211840821323620363/topicA-0/00000000000000000000.log
2025-01-23 13:13:51,631 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 1
2025-01-23 13:13:51,684 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=v_3Veo5vRom9QXayo7nXVQ:topicA-0, id=HvZqynBuR0eYRlhxxonpmg}
2025-01-23 13:13:51,688 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:13:51,721 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 2
2025-01-23 13:13:51,724 [kafka-rlm-copy-thread-pool-2] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for v_3Veo5vRom9QXayo7nXVQ:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8211840821323620363/topicA-0/00000000000000000002.log
2025-01-23 13:13:51,760 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 3
2025-01-23 13:13:51,762 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=v_3Veo5vRom9QXayo7nXVQ:topicA-0, id=KqXQdfcaQn2zsul7AICRMA}
2025-01-23 13:13:54,276 [kafka-rlm-expiration-thread-pool-5] INFO  kafka.log.remote.RemoteLogManager$RLMExpirationTask [] - [RemoteLogManager=0 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] About to delete remote log segment RemoteLogSegmentId{topicIdPartition=v_3Veo5vRom9QXayo7nXVQ:topicA-0, id=HvZqynBuR0eYRlhxxonpmg} due to log-start-offset 3 breach. Current earliest-epoch-entry: 0=3, segment-end-offset: 1 and segment-epochs: {0=0}
2025-01-23 13:13:54,314 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 4
2025-01-23 13:13:54,373 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 5
2025-01-23 13:13:54,420 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and follower partitions []
2025-01-23 13:13:54,420 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:54,432 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:54,426 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:54,471 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:54,482 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:54,483 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:54,489 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:54,492 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:54,492 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and follower partitions []
2025-01-23 13:13:54,497 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:54,500 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:54,520 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:54,524 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:54,528 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:54,534 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:54,534 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Found the logStartOffset: 2 for partition: v_3Veo5vRom9QXayo7nXVQ:topicA-0 after becoming leader
2025-01-23 13:13:54,538 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:54,538 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=3, leaderEpoch=0)] for partition: v_3Veo5vRom9QXayo7nXVQ:topicA-0 after becoming leader
2025-01-23 13:13:55,594 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copying 00000000000000000004.log to remote storage.
2025-01-23 13:13:55,619 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 6
2025-01-23 13:13:55,624 [kafka-rlm-copy-thread-pool-2] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for v_3Veo5vRom9QXayo7nXVQ:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-14017480522543243512/topicA-0/00000000000000000004.log
2025-01-23 13:13:55,667 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 7
2025-01-23 13:13:55,669 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copied 00000000000000000004.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=v_3Veo5vRom9QXayo7nXVQ:topicA-0, id=uvnq6F74RwCKiLIBN58imQ}
2025-01-23 13:13:56,177 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copying 00000000000000000006.log to remote storage.
2025-01-23 13:13:56,204 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 8
2025-01-23 13:13:56,207 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for v_3Veo5vRom9QXayo7nXVQ:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-14017480522543243512/topicA-0/00000000000000000006.log
2025-01-23 13:13:56,281 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 9
2025-01-23 13:13:56,284 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Copied 00000000000000000006.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=v_3Veo5vRom9QXayo7nXVQ:topicA-0, id=KQ3BiWMxSjqeGandSN7eMQ}
2025-01-23 13:13:58,568 [kafka-rlm-expiration-thread-pool-5] INFO  kafka.log.remote.RemoteLogManager$RLMExpirationTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] About to delete remote log segment RemoteLogSegmentId{topicIdPartition=v_3Veo5vRom9QXayo7nXVQ:topicA-0, id=uvnq6F74RwCKiLIBN58imQ} due to log-start-offset 7 breach. Current earliest-epoch-entry: 1=7, segment-end-offset: 5 and segment-epochs: {0=4, 1=5}
2025-01-23 13:13:58,586 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 10
2025-01-23 13:13:58,612 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 11
2025-01-23 13:13:58,631 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 12
2025-01-23 13:13:58,668 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 13
2025-01-23 13:13:58,672 [kafka-rlm-expiration-thread-pool-5] INFO  kafka.log.remote.RemoteLogManager$RLMExpirationTask [] - [RemoteLogManager=1 partition=v_3Veo5vRom9QXayo7nXVQ:topicA-0] Deleted remote log segment RemoteLogSegmentId{topicIdPartition=v_3Veo5vRom9QXayo7nXVQ:topicA-0, id=KqXQdfcaQn2zsul7AICRMA} due to leader-epoch-cache truncation. Current earliest-epoch-entry: EpochEntry(epoch=1, startOffset=7), segment-end-offset: 3 and segment-epochs: [0]
2025-01-23 13:13:58,943 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: v_3Veo5vRom9QXayo7nXVQ:topicA-0
2025-01-23 13:13:58,944 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower RLM task for partition: v_3Veo5vRom9QXayo7nXVQ:topicA-0
2025-01-23 13:13:58,946 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: v_3Veo5vRom9QXayo7nXVQ:topicA-0
2025-01-23 13:13:58,949 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:58,952 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [v_3Veo5vRom9QXayo7nXVQ:topicA-0]
2025-01-23 13:13:58,954 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:58,955 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [v_3Veo5vRom9QXayo7nXVQ:topicA-0] and removed: []
2025-01-23 13:13:58,958 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:58,966 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:58,966 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] and getting scheduled
2025-01-23 13:13:58,970 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[v_3Veo5vRom9QXayo7nXVQ:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:13:59,404 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:13:59,411 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:13:59,419 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:13:59,421 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:13:59,421 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:13:59,427 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:13:59,429 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:13:59,434 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:13:59,438 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:13:59,441 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:13:59,442 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:13:59,445 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:13:59,451 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:13:59,462 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:13:59,466 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:13:59,470 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:13:59,475 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:13:59,481 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:13:59,488 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:13:59,493 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:13:59,506 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:13:59,500 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:13:59,512 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:13:59,512 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:13:59,516 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:13:59,521 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:00,486 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-deletesegmentsduetologstartoffsetbreachtest9007150819350921578/kafka-tiered-storage]
2025-01-23 13:14:00,499 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:14:00,503 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:56151, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=9cwLPkhkSfmWR_6SvO67Eg, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-16028362537445652907}
2025-01-23 13:14:00,508 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:56151}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:56151, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:56151, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:14:00,520 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:00,635 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:00,644 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:14:00,651 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:14:00,866 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-deletesegmentsduetologstartoffsetbreachtest9007150819350921578] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:14:00,868 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Created local tiered storage manager [1]:[kafka-tiered-storage]
2025-01-23 13:14:00,869 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=5, remote.log.metadata.common.client.bootstrap.servers=localhost:56178, broker.id=1, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=9cwLPkhkSfmWR_6SvO67Eg, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2505964008388515325}
2025-01-23 13:14:00,869 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_1', metadataTopicPartitionsCount=5, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:56178}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:56178, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_1_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:56178, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_1_producer}}
2025-01-23 13:14:00,871 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:00,942 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:00,964 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:01,007 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: OyWsc99pT-We2Yl7qbhXxg, numPartitions: 5, replicationFactor: 2, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:14:01,008 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic [__remote_log_metadata] already exists
2025-01-23 13:14:01,013 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:14:01,019 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:14:01,338 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:01,341 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:01,338 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:01,345 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:01,348 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:01,345 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:01,464 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:01,469 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:01,472 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:01,472 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:01,475 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:01,491 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and follower partitions []
2025-01-23 13:14:01,497 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:01,498 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:01,498 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:01,498 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:01,512 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:01,528 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:01,595 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 112 ms
2025-01-23 13:14:01,626 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 104 ms
2025-01-23 13:14:01,629 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and follower partitions []
2025-01-23 13:14:01,629 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:01,632 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:01,632 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:01,695 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and follower partitions []
2025-01-23 13:14:01,700 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:01,701 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:01,728 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:02,015 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Found the logStartOffset: 0 for partition: 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 after becoming leader
2025-01-23 13:14:02,021 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 after becoming leader
2025-01-23 13:14:02,036 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:02,069 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 0
2025-01-23 13:14:02,124 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-deletesegmentsduetologstartoffsetbreachtest9007150819350921578/kafka-tiered-storage/topicA-0-2OLsD5Z_QkaDG4YGzZBXMA
2025-01-23 13:14:02,131 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-13299837074355538719/topicA-0/00000000000000000000.log
2025-01-23 13:14:02,221 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 1
2025-01-23 13:14:02,223 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0, id=b_FzItphS_aH7CHoirFoGQ}
2025-01-23 13:14:02,224 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:02,243 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 2
2025-01-23 13:14:02,244 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-13299837074355538719/topicA-0/00000000000000000002.log
2025-01-23 13:14:02,255 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 3
2025-01-23 13:14:02,255 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0, id=f52S4K8XR6uCiXqI88TloQ}
2025-01-23 13:14:04,552 [kafka-rlm-expiration-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMExpirationTask [] - [RemoteLogManager=0 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] About to delete remote log segment RemoteLogSegmentId{topicIdPartition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0, id=b_FzItphS_aH7CHoirFoGQ} due to log-start-offset 3 breach. Current earliest-epoch-entry: 0=3, segment-end-offset: 1 and segment-epochs: {0=0}
2025-01-23 13:14:04,576 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 4
2025-01-23 13:14:04,601 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 5
2025-01-23 13:14:04,882 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:04,889 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:04,890 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and follower partitions []
2025-01-23 13:14:04,899 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:04,918 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:04,920 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:04,928 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:04,934 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:04,940 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:04,946 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:04,986 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and follower partitions []
2025-01-23 13:14:04,992 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:05,004 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:05,008 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:05,014 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:05,018 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:05,022 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:05,018 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Found the logStartOffset: 2 for partition: 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 after becoming leader
2025-01-23 13:14:05,030 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=3, leaderEpoch=0)] for partition: 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 after becoming leader
2025-01-23 13:14:05,557 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copying 00000000000000000004.log to remote storage.
2025-01-23 13:14:05,578 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 6
2025-01-23 13:14:05,585 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2505964008388515325/topicA-0/00000000000000000004.log
2025-01-23 13:14:05,633 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 7
2025-01-23 13:14:05,637 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copied 00000000000000000004.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0, id=cKxLphNERzKqB6xEa22GwA}
2025-01-23 13:14:05,641 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copying 00000000000000000006.log to remote storage.
2025-01-23 13:14:05,658 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 8
2025-01-23 13:14:05,661 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2505964008388515325/topicA-0/00000000000000000006.log
2025-01-23 13:14:05,700 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 9
2025-01-23 13:14:05,702 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Copied 00000000000000000006.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0, id=DGxCx7KVTvWP-n20ElerBw}
2025-01-23 13:14:08,051 [kafka-rlm-expiration-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMExpirationTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] About to delete remote log segment RemoteLogSegmentId{topicIdPartition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0, id=cKxLphNERzKqB6xEa22GwA} due to log-start-offset 7 breach. Current earliest-epoch-entry: 1=7, segment-end-offset: 5 and segment-epochs: {0=4, 1=5}
2025-01-23 13:14:08,067 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 10
2025-01-23 13:14:08,135 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 11
2025-01-23 13:14:08,165 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 12
2025-01-23 13:14:08,229 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 3 up-to offset 13
2025-01-23 13:14:08,232 [kafka-rlm-expiration-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMExpirationTask [] - [RemoteLogManager=1 partition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] Deleted remote log segment RemoteLogSegmentId{topicIdPartition=2OLsD5Z_QkaDG4YGzZBXMA:topicA-0, id=f52S4K8XR6uCiXqI88TloQ} due to leader-epoch-cache truncation. Current earliest-epoch-entry: EpochEntry(epoch=1, startOffset=7), segment-end-offset: 3 and segment-epochs: [0]
2025-01-23 13:14:08,310 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower RLM task for partition: 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0
2025-01-23 13:14:08,311 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0
2025-01-23 13:14:08,313 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:08,316 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: 2OLsD5Z_QkaDG4YGzZBXMA:topicA-0
2025-01-23 13:14:08,320 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:08,325 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0]
2025-01-23 13:14:08,330 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:08,334 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and removed: []
2025-01-23 13:14:08,338 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] and getting scheduled
2025-01-23 13:14:08,338 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:08,338 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[2OLsD5Z_QkaDG4YGzZBXMA:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:08,700 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:08,710 [scala-execution-context-global-244] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:08,716 [scala-execution-context-global-244] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:08,717 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:08,721 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:08,721 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:08,723 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:08,723 [scala-execution-context-global-241] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:08,723 [scala-execution-context-global-244] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:08,724 [scala-execution-context-global-244] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:08,725 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:08,725 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:08,729 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:08,729 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:08,732 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:08,732 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:08,734 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:08,734 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:08,733 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:08,735 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:08,735 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:08,740 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:08,740 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:08,741 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:08,741 [scala-execution-context-global-241] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:08,741 [scala-execution-context-global-244] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:09,770 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest7653383692749205687/kafka-tiered-storage]
2025-01-23 13:14:09,784 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:14:09,784 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=2, remote.log.metadata.common.client.bootstrap.servers=localhost:56852, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=exRS5Z0CT4-z6L8-YI--wQ, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-4335374151511809146}
2025-01-23 13:14:09,788 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=2, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:56852}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:56852, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:56852, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:14:09,788 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:09,906 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:09,916 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:14:09,918 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:14:09,957 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest7653383692749205687] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:14:09,958 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Created local tiered storage manager [1]:[kafka-tiered-storage]
2025-01-23 13:14:09,962 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=2, remote.log.metadata.common.client.bootstrap.servers=localhost:56870, broker.id=1, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=exRS5Z0CT4-z6L8-YI--wQ, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-16398439475020571160}
2025-01-23 13:14:09,962 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_1', metadataTopicPartitionsCount=2, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:56870}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:56870, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_1_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:56870, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_1_producer}}
2025-01-23 13:14:09,963 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:10,051 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:10,116 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: eXzukUw6SzalmQuMTH6g9Q, numPartitions: 2, replicationFactor: 2, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:14:10,133 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:14:10,224 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:10,227 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic [__remote_log_metadata] already exists
2025-01-23 13:14:10,233 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:14:10,443 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:10,443 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:10,449 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:10,546 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:10,546 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:10,550 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:10,694 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-1] and follower partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-0]
2025-01-23 13:14:10,694 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-0] and follower partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-1]
2025-01-23 13:14:10,699 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-1, KALFJuUXSDSSdV6IQF0Kag:topicA-0] and removed: []
2025-01-23 13:14:10,700 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-1, KALFJuUXSDSSdV6IQF0Kag:topicA-0] and removed: []
2025-01-23 13:14:10,704 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:10,703 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] and getting scheduled
2025-01-23 13:14:10,709 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:10,709 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] and getting scheduled
2025-01-23 13:14:10,709 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:10,710 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] and getting scheduled
2025-01-23 13:14:10,714 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:10,723 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:10,730 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] and getting scheduled
2025-01-23 13:14:10,736 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] and getting scheduled
2025-01-23 13:14:10,748 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:10,743 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:10,751 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] and getting scheduled
2025-01-23 13:14:10,754 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:10,815 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 1 meta-partitions in 106 ms
2025-01-23 13:14:10,817 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 1 meta-partitions in 104 ms
2025-01-23 13:14:10,899 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-1] and follower partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-0]
2025-01-23 13:14:10,902 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-1, KALFJuUXSDSSdV6IQF0Kag:topicA-0] and removed: []
2025-01-23 13:14:10,914 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-0] and follower partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-1]
2025-01-23 13:14:10,918 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-1, KALFJuUXSDSSdV6IQF0Kag:topicA-0] and removed: []
2025-01-23 13:14:11,242 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Found the logStartOffset: 0 for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0 after becoming leader
2025-01-23 13:14:11,247 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0 after becoming leader
2025-01-23 13:14:11,250 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:11,255 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Found the logStartOffset: 0 for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1 after becoming leader
2025-01-23 13:14:11,267 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1 after becoming leader
2025-01-23 13:14:11,511 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 0
2025-01-23 13:14:11,514 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest7653383692749205687/kafka-tiered-storage/topicA-0-KALFJuUXSDSSdV6IQF0Kag
2025-01-23 13:14:11,517 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for KALFJuUXSDSSdV6IQF0Kag:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8992762850950473660/topicA-0/00000000000000000000.log
2025-01-23 13:14:11,571 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 1
2025-01-23 13:14:11,574 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=KALFJuUXSDSSdV6IQF0Kag:topicA-0, id=h_XYN8dNSZqCwa5Jmh-GQw}
2025-01-23 13:14:11,574 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:14:11,590 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 2
2025-01-23 13:14:11,593 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for KALFJuUXSDSSdV6IQF0Kag:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-8992762850950473660/topicA-0/00000000000000000001.log
2025-01-23 13:14:11,622 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 3
2025-01-23 13:14:11,625 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=KALFJuUXSDSSdV6IQF0Kag:topicA-0, id=as8cVrGjRQ6xg-_9lYczLw}
2025-01-23 13:14:13,804 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:13,841 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 4
2025-01-23 13:14:13,844 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest7653383692749205687/kafka-tiered-storage/topicA-1-KALFJuUXSDSSdV6IQF0Kag
2025-01-23 13:14:13,855 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for KALFJuUXSDSSdV6IQF0Kag:topicA-1 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-16398439475020571160/topicA-1/00000000000000000000.log
2025-01-23 13:14:13,881 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 5
2025-01-23 13:14:13,887 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=KALFJuUXSDSSdV6IQF0Kag:topicA-1, id=wI-g5oMBRHeJat6XjfZfsQ}
2025-01-23 13:14:13,892 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:14:13,920 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 6
2025-01-23 13:14:13,927 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for KALFJuUXSDSSdV6IQF0Kag:topicA-1 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-16398439475020571160/topicA-1/00000000000000000001.log
2025-01-23 13:14:13,961 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 7
2025-01-23 13:14:13,963 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=KALFJuUXSDSSdV6IQF0Kag:topicA-1, id=lgbbLmLwTrKlR6JuAVT1qg}
2025-01-23 13:14:16,072 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-0] and follower partitions []
2025-01-23 13:14:16,076 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-0] and removed: []
2025-01-23 13:14:16,076 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0]
2025-01-23 13:14:16,076 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] and getting scheduled
2025-01-23 13:14:16,076 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:16,077 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] and getting scheduled
2025-01-23 13:14:16,080 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0
2025-01-23 13:14:16,077 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Found the logStartOffset: 0 for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0 after becoming leader
2025-01-23 13:14:16,080 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:16,080 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0
2025-01-23 13:14:16,080 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0 after becoming leader
2025-01-23 13:14:16,084 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [] and removed: [KALFJuUXSDSSdV6IQF0Kag:topicA-0]
2025-01-23 13:14:16,110 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-1] and follower partitions []
2025-01-23 13:14:16,114 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-1] and removed: []
2025-01-23 13:14:16,118 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1]
2025-01-23 13:14:16,122 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] and getting scheduled
2025-01-23 13:14:16,128 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:16,132 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] and getting scheduled
2025-01-23 13:14:16,132 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Found the logStartOffset: 0 for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1 after becoming leader
2025-01-23 13:14:16,140 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1
2025-01-23 13:14:16,140 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1 after becoming leader
2025-01-23 13:14:16,136 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:16,144 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1
2025-01-23 13:14:16,145 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [] and removed: [KALFJuUXSDSSdV6IQF0Kag:topicA-1]
2025-01-23 13:14:16,180 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 1
2025-01-23 13:14:16,182 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 1
2025-01-23 13:14:16,285 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 101 ms
2025-01-23 13:14:16,289 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 101 ms
2025-01-23 13:14:16,592 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:16,604 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 8
2025-01-23 13:14:16,605 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for KALFJuUXSDSSdV6IQF0Kag:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-5737386497225976058/topicA-0/00000000000000000002.log
2025-01-23 13:14:16,620 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 9
2025-01-23 13:14:16,623 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=KALFJuUXSDSSdV6IQF0Kag:topicA-0, id=aIAVNMF-QYiXrfSMrVOpfw}
2025-01-23 13:14:17,654 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:17,661 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 10
2025-01-23 13:14:17,662 [kafka-rlm-copy-thread-pool-2] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for KALFJuUXSDSSdV6IQF0Kag:topicA-1 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-4335374151511809146/topicA-1/00000000000000000002.log
2025-01-23 13:14:17,670 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 1 up-to offset 11
2025-01-23 13:14:17,671 [kafka-rlm-copy-thread-pool-2] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=KALFJuUXSDSSdV6IQF0Kag:topicA-1] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=KALFJuUXSDSSdV6IQF0Kag:topicA-1, id=KiiNITxESPerWpw2PEMx2A}
2025-01-23 13:14:18,946 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1
2025-01-23 13:14:18,946 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0
2025-01-23 13:14:18,948 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-0
2025-01-23 13:14:18,948 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: KALFJuUXSDSSdV6IQF0Kag:topicA-1
2025-01-23 13:14:18,949 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-1]
2025-01-23 13:14:18,949 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-1] and removed: []
2025-01-23 13:14:18,950 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] and getting scheduled
2025-01-23 13:14:18,950 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [KALFJuUXSDSSdV6IQF0Kag:topicA-0]
2025-01-23 13:14:18,950 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:18,950 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [KALFJuUXSDSSdV6IQF0Kag:topicA-0] and removed: []
2025-01-23 13:14:18,950 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] and getting scheduled
2025-01-23 13:14:18,950 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[KALFJuUXSDSSdV6IQF0Kag:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:19,244 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:19,249 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:19,253 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:19,256 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:19,256 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:19,260 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:19,261 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:19,264 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:19,265 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:19,270 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:19,274 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:19,286 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:19,282 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:19,290 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:19,294 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:19,294 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:19,298 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:19,298 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:19,298 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:19,298 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:19,306 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:19,310 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:19,310 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:19,316 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:19,320 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:19,324 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:20,555 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Creating directory: [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest9572286819406481915/kafka-tiered-storage]
2025-01-23 13:14:20,556 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Created local tiered storage manager [0]:[kafka-tiered-storage]
2025-01-23 13:14:20,556 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=2, remote.log.metadata.common.client.bootstrap.servers=localhost:57395, broker.id=0, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=4sXdZ5JiSx6uc7OdJTY45g, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2853890197163660099}
2025-01-23 13:14:20,556 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_0', metadataTopicPartitionsCount=2, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:57395}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:57395, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_0_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:57395, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_0_producer}}
2025-01-23 13:14:20,557 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:20,630 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:20,635 [RLMMInitializationThread] ERROR org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Encountered error while creating __remote_log_metadata topic.
java.util.concurrent.ExecutionException: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:396) ~[?:?]
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2073) ~[?:?]
	at org.apache.kafka.common.internals.KafkaFutureImpl.get(KafkaFutureImpl.java:155) ~[kafka-clients-4.1.0-SNAPSHOT.jar:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.createTopic(TopicBasedRemoteLogMetadataManager.java:538) ~[main/:?]
	at org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager.initializeResources(TopicBasedRemoteLogMetadataManager.java:424) ~[main/:?]
	at java.base/java.lang.Thread.run(Thread.java:1583) [?:?]
Caused by: org.apache.kafka.common.errors.InvalidReplicationFactorException: Unable to replicate the partition 2 time(s): The target replication factor of 2 cannot be reached because only 1 broker(s) are registered.
2025-01-23 13:14:20,638 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Sleep for 300 ms before it is retried again.
2025-01-23 13:14:20,685 [Test worker] WARN  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Remote storage with ID [/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest9572286819406481915] already exists on the file system. Any data already in the remote storage will not be deleted and may result in an inconsistent state and/or provide stale data.
2025-01-23 13:14:20,688 [Test worker] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Created local tiered storage manager [1]:[kafka-tiered-storage]
2025-01-23 13:14:20,688 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Started configuring topic-based RLMM with configs: {remote.log.metadata.topic.replication.factor=2, remote.log.metadata.topic.num.partitions=2, remote.log.metadata.common.client.bootstrap.servers=localhost:57409, broker.id=1, remote.log.metadata.initialization.retry.interval.ms=300, remote.log.metadata.common.client.security.protocol=PLAINTEXT, cluster.id=4sXdZ5JiSx6uc7OdJTY45g, log.dir=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-13030464985452646155}
2025-01-23 13:14:20,688 [Test worker] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Successfully configured topic-based RLMM with config: TopicBasedRemoteLogMetadataManagerConfig{clientIdPrefix='__remote_log_metadata_client_1', metadataTopicPartitionsCount=2, consumeWaitMs=120000, metadataTopicRetentionMs=-1, metadataTopicReplicationFactor=2, initializationRetryMaxTimeoutMs=120000, initializationRetryIntervalMs=300, commonProps={security.protocol=PLAINTEXT, bootstrap.servers=localhost:57409}, consumerProps={security.protocol=PLAINTEXT, key.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, value.deserializer=org.apache.kafka.common.serialization.ByteArrayDeserializer, enable.auto.commit=false, bootstrap.servers=localhost:57409, exclude.internal.topics=false, auto.offset.reset=earliest, client.id=__remote_log_metadata_client_1_consumer}, producerProps={security.protocol=PLAINTEXT, enable.idempotence=true, value.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, acks=all, bootstrap.servers=localhost:57409, key.serializer=org.apache.kafka.common.serialization.ByteArraySerializer, client.id=__remote_log_metadata_client_1_producer}}
2025-01-23 13:14:20,688 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initializing topic-based RLMM resources
2025-01-23 13:14:20,760 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata does not exist. Error: This server does not host this topic-partition.
2025-01-23 13:14:20,794 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata created. TopicId: ePVXEvcTSNeXNfhb7DQfvA, numPartitions: 2, replicationFactor: 2, config: [remote.storage.enable=false, cleanup.policy=delete, retention.ms=-1, file.delete.delay.ms=1000]
2025-01-23 13:14:20,800 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:20,800 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:20,802 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:20,944 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Topic __remote_log_metadata exists. TopicId: ePVXEvcTSNeXNfhb7DQfvA, numPartitions: 2, 
2025-01-23 13:14:20,946 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - RLMM Consumer task thread is started
2025-01-23 13:14:20,949 [RLMMInitializationThread] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Initialized topic-based RLMM resources successfully
2025-01-23 13:14:20,946 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Starting consumer task thread.
2025-01-23 13:14:21,053 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and follower partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-1]
2025-01-23 13:14:21,053 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and follower partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-0]
2025-01-23 13:14:21,057 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-1, B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and removed: []
2025-01-23 13:14:21,057 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-1, B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and removed: []
2025-01-23 13:14:21,057 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and getting scheduled
2025-01-23 13:14:21,057 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and getting scheduled
2025-01-23 13:14:21,057 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:21,057 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:21,057 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:21,057 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 0
2025-01-23 13:14:21,058 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and getting scheduled
2025-01-23 13:14:21,061 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:21,061 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and getting scheduled
2025-01-23 13:14:21,061 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:21,061 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and getting scheduled
2025-01-23 13:14:21,061 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and getting scheduled
2025-01-23 13:14:21,071 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:21,067 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:21,160 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 1 meta-partitions in 103 ms
2025-01-23 13:14:21,163 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 2 assigned user-partitions mapped to the 1 meta-partitions in 102 ms
2025-01-23 13:14:21,203 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and follower partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-0]
2025-01-23 13:14:21,203 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and follower partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-1]
2025-01-23 13:14:21,206 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-1, B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and removed: []
2025-01-23 13:14:21,206 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-1, B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and removed: []
2025-01-23 13:14:21,563 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Found the logStartOffset: 0 for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0 after becoming leader
2025-01-23 13:14:21,563 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Found the logStartOffset: 0 for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1 after becoming leader
2025-01-23 13:14:21,564 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0 after becoming leader
2025-01-23 13:14:21,564 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Found the highest copiedRemoteOffset: Optional[(offset=-1, leaderEpoch=-1)] for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1 after becoming leader
2025-01-23 13:14:21,564 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:21,580 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 0
2025-01-23 13:14:21,580 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest9572286819406481915/kafka-tiered-storage/topicA-0-B-3E9YpkTTG8S4EIjSBn7w
2025-01-23 13:14:21,580 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for B-3E9YpkTTG8S4EIjSBn7w:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2853890197163660099/topicA-0/00000000000000000000.log
2025-01-23 13:14:21,588 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 1
2025-01-23 13:14:21,588 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0, id=5euvCfrNSGu1BnYFQfzY6Q}
2025-01-23 13:14:21,588 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:14:21,595 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 2
2025-01-23 13:14:21,595 [kafka-rlm-copy-thread-pool-1] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for B-3E9YpkTTG8S4EIjSBn7w:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2853890197163660099/topicA-0/00000000000000000001.log
2025-01-23 13:14:21,603 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 3
2025-01-23 13:14:21,603 [kafka-rlm-copy-thread-pool-1] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0, id=TcyzuXT4SpGksHxUgtj0Hg}
2025-01-23 13:14:24,080 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Copying 00000000000000000000.log to remote storage.
2025-01-23 13:14:24,096 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 4
2025-01-23 13:14:24,099 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.RemoteTopicPartitionDirectory [] - Creating directory: /var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-remote-tier-reassignreplicashrinktest9572286819406481915/kafka-tiered-storage/topicA-1-B-3E9YpkTTG8S4EIjSBn7w
2025-01-23 13:14:24,099 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for B-3E9YpkTTG8S4EIjSBn7w:topicA-1 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-1783134069221906608/topicA-1/00000000000000000000.log
2025-01-23 13:14:24,134 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 5
2025-01-23 13:14:24,137 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Copied 00000000000000000000.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1, id=9D-7fjk9S_6umF68th33_w}
2025-01-23 13:14:24,137 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Copying 00000000000000000001.log to remote storage.
2025-01-23 13:14:24,148 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 6
2025-01-23 13:14:24,148 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for B-3E9YpkTTG8S4EIjSBn7w:topicA-1 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-1783134069221906608/topicA-1/00000000000000000001.log
2025-01-23 13:14:24,156 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 7
2025-01-23 13:14:24,156 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Copied 00000000000000000001.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1, id=CX_GPWouQvSa_m-cbsNFGw}
2025-01-23 13:14:26,229 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and follower partitions []
2025-01-23 13:14:26,232 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and removed: []
2025-01-23 13:14:26,233 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0]
2025-01-23 13:14:26,238 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and getting scheduled
2025-01-23 13:14:26,237 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0
2025-01-23 13:14:26,239 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:26,239 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and getting scheduled
2025-01-23 13:14:26,239 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:26,239 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Found the logStartOffset: 0 for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0 after becoming leader
2025-01-23 13:14:26,239 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0 after becoming leader
2025-01-23 13:14:26,239 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0
2025-01-23 13:14:26,240 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [] and removed: [B-3E9YpkTTG8S4EIjSBn7w:topicA-0]
2025-01-23 13:14:26,257 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and follower partitions []
2025-01-23 13:14:26,257 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and removed: []
2025-01-23 13:14:26,257 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1]
2025-01-23 13:14:26,261 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new copy task: class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and getting scheduled
2025-01-23 13:14:26,261 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMCopyTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:26,261 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new expiration task: class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and getting scheduled
2025-01-23 13:14:26,262 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMExpirationTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:26,262 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Found the logStartOffset: 0 for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1 after becoming leader
2025-01-23 13:14:26,262 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Found the highest copiedRemoteOffset: Optional[(offset=1, leaderEpoch=0)] for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1 after becoming leader
2025-01-23 13:14:26,270 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1
2025-01-23 13:14:26,270 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1
2025-01-23 13:14:26,271 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [] and removed: [B-3E9YpkTTG8S4EIjSBn7w:topicA-1]
2025-01-23 13:14:26,272 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 1
2025-01-23 13:14:26,375 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 100 ms
2025-01-23 13:14:26,375 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Unassigned user-topic-partitions: 1
2025-01-23 13:14:26,477 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Initialized for all the 1 assigned user-partitions mapped to the 1 meta-partitions in 101 ms
2025-01-23 13:14:26,745 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:26,752 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 8
2025-01-23 13:14:26,753 [kafka-rlm-copy-thread-pool-4] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=1] Offloading log segment for B-3E9YpkTTG8S4EIjSBn7w:topicA-0 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-13030464985452646155/topicA-0/00000000000000000002.log
2025-01-23 13:14:26,765 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 9
2025-01-23 13:14:26,765 [kafka-rlm-copy-thread-pool-4] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=1 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=B-3E9YpkTTG8S4EIjSBn7w:topicA-0, id=C7QHbsfgSXGi_2udlj69XA}
2025-01-23 13:14:27,776 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Copying 00000000000000000002.log to remote storage.
2025-01-23 13:14:27,785 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 10
2025-01-23 13:14:27,787 [kafka-rlm-copy-thread-pool-7] INFO  org.apache.kafka.server.log.remote.storage.LocalTieredStorage [] - [LocalTieredStorage Id=0] Offloading log segment for B-3E9YpkTTG8S4EIjSBn7w:topicA-1 from segment=/var/folders/gw/kpkg_dtx5bvgzgg_1jzmt76h0000gn/T/kafka-2492005658885956318/topicA-1/00000000000000000002.log
2025-01-23 13:14:27,802 [ForkJoinPool.commonPool-worker-1] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerManager [] - Wait until the consumer is caught up with the target partition 0 up-to offset 11
2025-01-23 13:14:27,802 [kafka-rlm-copy-thread-pool-7] INFO  kafka.log.remote.RemoteLogManager$RLMCopyTask [] - [RemoteLogManager=0 partition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1] Copied 00000000000000000002.log to remote storage with segment-id: RemoteLogSegmentId{topicIdPartition=B-3E9YpkTTG8S4EIjSBn7w:topicA-1, id=uqAV_yDUTs2nXvKQFIy1FQ}
2025-01-23 13:14:28,912 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1
2025-01-23 13:14:28,912 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the copy RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0
2025-01-23 13:14:28,915 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-0
2025-01-23 13:14:28,915 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Cancelling the expiration RLM task for partition: B-3E9YpkTTG8S4EIjSBn7w:topicA-1
2025-01-23 13:14:28,916 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-1]
2025-01-23 13:14:28,916 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Received leadership notifications with leader partitions [] and follower partitions [B-3E9YpkTTG8S4EIjSBn7w:topicA-0]
2025-01-23 13:14:28,916 [kafka-0-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and removed: []
2025-01-23 13:14:28,916 [kafka-1-metadata-loader-event-handler] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Updating assignments for partitions added: [B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and removed: []
2025-01-23 13:14:28,916 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] and getting scheduled
2025-01-23 13:14:28,916 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager [] - Created a new follower task: class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] and getting scheduled
2025-01-23 13:14:28,916 [kafka-1-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-0] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:28,916 [kafka-0-metadata-loader-event-handler] INFO  kafka.log.remote.RemoteLogManager$RLMScheduledThreadPool [] - Scheduling runnable class kafka.log.remote.RemoteLogManager$RLMFollowerTask[B-3E9YpkTTG8S4EIjSBn7w:topicA-1] with initial delay: 0, fixed delay: 500
2025-01-23 13:14:29,120 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:29,121 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:29,124 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closing topic-based RLMM resources
2025-01-23 13:14:29,125 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:29,125 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:29,125 [scala-execution-context-global-243] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:29,125 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:29,126 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Closing the instance
2025-01-23 13:14:29,126 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:29,126 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:29,126 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:29,126 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:29,126 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:29,127 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:29,127 [scala-execution-context-global-243] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
2025-01-23 13:14:29,127 [RLMMConsumerTask] INFO  org.apache.kafka.server.log.remote.metadata.storage.ConsumerTask [] - Exited from consumer task thread
2025-01-23 13:14:29,127 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.RemotePartitionMetadataStore [] - Clearing the entries from the store.
2025-01-23 13:14:29,127 [scala-execution-context-global-242] INFO  org.apache.kafka.server.log.remote.metadata.storage.TopicBasedRemoteLogMetadataManager [] - Closed topic-based RLMM resources
2025-01-23 13:14:29,128 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMCopyThreadPool executor
2025-01-23 13:14:29,128 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMCopyThreadPool executor shutdown completed
2025-01-23 13:14:29,128 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMExpirationThreadPool executor
2025-01-23 13:14:29,128 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMExpirationThreadPool executor shutdown completed
2025-01-23 13:14:29,128 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RLMFollowerScheduledThreadPool executor
2025-01-23 13:14:29,128 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RLMFollowerScheduledThreadPool executor shutdown completed
2025-01-23 13:14:29,128 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - Shutting down RemoteStorageReaderThreadPool executor
2025-01-23 13:14:29,129 [scala-execution-context-global-242] INFO  kafka.log.remote.RemoteLogManager [] - RemoteStorageReaderThreadPool executor shutdown completed
